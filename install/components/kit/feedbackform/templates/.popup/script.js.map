{"version":3,"sources":["popup.js"],"names":["window","interlabs","feedbackform","$","document","ready","__validatorMessages","extend","validator","messages","length","each","form","div","removeClass","attributes","specified","console","log","name","value","attr","html","replaceWith","on","event","preventDefault","stopPropagation","container","dialog","find","parents","remove","off","closeButton","addClass","el","formData","FormData","get","errorContainer","url","prop","valid","ajax","type","processData","contentType","data","success","errors","error","append","message","val","fail","callback"],"mappings":"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","file":"script.js","sourcesContent":["if (typeof window.interlabs === \"undefined\") {\r\n    window.interlabs = {};\r\n}\r\nif (typeof window.interlabs.feedbackform === \"undefined\") {\r\n    window.interlabs.feedbackform = {};\r\n}\r\n\r\n\r\n$(document).ready(function () {\r\n\r\n    if (typeof window.__validatorMessages === \"object\") {\r\n        $.extend($.validator.messages, window.__validatorMessages);\r\n    }\r\n\r\n    //convert tag div to form on AJAX_MODE=Y\r\n    if ($('.js-div-to-form-convert').length > 0) {\r\n        $('.js-div-to-form-convert').each(function () {\r\n            const form = $('<form></form>');\r\n            const div = $(this);\r\n\r\n            div.removeClass('js-div-to-form-convert')\r\n                .each(function () {\r\n                    $.each(this.attributes, function () {\r\n                        // this.attributes is not a plain object, but an array\r\n                        // of attribute nodes, which contain both the name and value\r\n                        if (this.specified) {\r\n                            console.log(this.name, this.value);\r\n                            form.attr(this.name, this.value)\r\n                        }\r\n                    });\r\n                    form.html(div.html())\r\n                })\r\n                .replaceWith(form);\r\n            form.on('submit', function (event) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                return false;\r\n            })\r\n\r\n        });\r\n    }\r\n\r\n\r\n    $('.interlabs-feedbackform__container').each(function () {\r\n        const container = $(this);\r\n        const dialog = container.find('.interlabs-feedbackform__container__dialog');\r\n\r\n\r\n        /**\r\n         * open dialog\r\n         */\r\n        container.find('.js-interlabs-feedbackform__container-show-button').on('click', function () {\r\n            const container = $(this).parents('.interlabs-feedbackform__container:first');\r\n            const dialog = container.find('.interlabs-feedbackform__container__dialog');\r\n            dialog.find('.interlabs-feedbackform__container__errors .interlabs-feedbackform__container__errors__item').remove();\r\n            dialog.removeClass('hidden');\r\n\r\n\r\n            /**\r\n             * close main dialog\r\n             */\r\n            dialog.find('.js-interlabs-feedbackform__dialog__close, .js-interlabs-feedbackform__dialog__cancel-button')\r\n                .off('click')\r\n                .on('click', function () {\r\n                    const closeButton = $(this);\r\n                    const container = closeButton.parents('.interlabs-feedbackform__container:first');\r\n                    const dialog = container.find('.interlabs-feedbackform__container__dialog');\r\n                    dialog.addClass('hidden');\r\n                });\r\n        });\r\n\r\n\r\n        /**\r\n         * close info dialog\r\n         */\r\n        container.find('.js-interlabs-feedbackform__dialog__close').on('click', function () {\r\n            $(this).parents('.interlabs-feedbackform__container-succsess:first').addClass('hidden');\r\n        });\r\n\r\n        /**\r\n         * Ajax send request\r\n         */\r\n        dialog.find('.ajax .js-interlabs-feedbackform__dialog__send-button').on('click', function () {\r\n            const el = $(this);\r\n            const container = el.parents('.interlabs-feedbackform__container:first');\r\n            const dialog = container.find('.interlabs-feedbackform__container__dialog');\r\n\r\n            const form = dialog.find('form');\r\n            let formData = new FormData(form.get(0));\r\n\r\n            const errorContainer = container.find('.interlabs-feedbackform__container__errors');\r\n            if (errorContainer) {\r\n                errorContainer.html();\r\n            }\r\n            let url = form.prop(\"action\");\r\n\r\n            if (!form.valid()) {\r\n                return;\r\n            }\r\n\r\n            $.ajax({\r\n                type: 'POST',\r\n                //contentType: \"application/json; charset=utf-8\",\r\n                //dataType: \"json\",\r\n                url: url,\r\n                processData: false,\r\n                contentType: false,\r\n                data: formData,\r\n                success: function (data) {\r\n                    if (data.errors) {\r\n                        // show errors\r\n                        errorContainer.find('.interlabs-feedbackform__container__errors__item').remove();\r\n                        for (const error of data.errors) {\r\n                            if (errorContainer) {\r\n                                errorContainer.append(`<label class=\"interlabs-feedbackform__container__errors__item\">${error.message}</label>`);\r\n                            } else {\r\n                                console.log(error.message);\r\n                            }\r\n\r\n                        }\r\n\r\n                    } else {\r\n                        //data.data\r\n                        dialog.addClass('hidden');\r\n                        container.find('.interlabs-feedbackform__container-succsess').removeClass('hidden');\r\n                        container.find('.interlabs-feedbackform__container-succsess .interlabs-feedbackform__container-succsess__close').on('click',function(){\r\n                            container.find('.interlabs-feedbackform__container-succsess').addClass('hidden');\r\n                        });\r\n                        dialog.find('input[name=\"AGREE_PROCESSING\"]').prop('checked', false);\r\n                        dialog.find('input[type=\"file\"]').val('');\r\n\r\n                    }\r\n\r\n                },\r\n                fail: function () {\r\n                    callback(true, null);\r\n                }\r\n\r\n            });\r\n        });\r\n    });\r\n\r\n});"]}